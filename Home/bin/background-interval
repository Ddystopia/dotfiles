#!/bin/bash

# bgInterval timeout wallpapers_dir proc_name

TIMEOUT=${1:-30}
WALLPAPERS_DIR__LOCAL=${2:-${WALLPAPERS_DIR}}
PROC_NAME=${3:-"background-interval"}

if [[ -z $TIMEOUT ]] || [[ -z $WALLPAPERS_DIR__LOCAL ]]
then
  exit 1
fi

printf $PROC_NAME > /proc/$$/comm

while true
do
  monitors=$(xrandr --listactivemonitors | head -1 | awk '{ print $2 }')
  wallpaper=$(find "$WALLPAPERS_DIR" -type f | shuf -n 1)
  for ((i = 0 ; i < $monitors ; i++)); do
    echo "Here $i"
    nitrogen --set-zoom-fill $wallpaper --head=$i
  done
  sleep $TIMEOUT
done
